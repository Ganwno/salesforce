"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9718],{69718:function(sn,be,t){t.r(be),t.d(be,{default:function(){return on}});var $e=t(97857),z=t.n($e),ze=t(15009),L=t.n(ze),Fe=t(99289),q=t.n(Fe),Ee=t(19632),De=t.n(Ee),Oe=t(5574),h=t.n(Oe),c=t(67294),Ze=t(15045),We=t(75302),_=t(27790),we=t(92195),me=t(71230),w=t(15746),m=t(7075),Be=t(66477),Ve=t(57953),Ue=t(26713),Ye=t(71577),Ge=t(31530),ve=t(41687),Ke=t(24969),Xe=t(80331),Ne=t(12699),He=t(93417),Re=t(66419),Ae=t(21035),Je=t(16165),e=t(85893),Qe=function(){return(0,e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",children:[(0,e.jsx)("g",{transform:"translate(20 50)",children:(0,e.jsx)("circle",{cx:"0",cy:"0",r:"6",fill:"#03cdc1",children:(0,e.jsx)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.3440366972477064s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"0.9174311926605504s",repeatCount:"indefinite"})})}),(0,e.jsx)("g",{transform:"translate(40 50)",children:(0,e.jsx)("circle",{cx:"0",cy:"0",r:"6",fill:"#52c4d1",children:(0,e.jsx)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.2293577981651376s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"0.9174311926605504s",repeatCount:"indefinite"})})}),(0,e.jsx)("g",{transform:"translate(60 50)",children:(0,e.jsx)("circle",{cx:"0",cy:"0",r:"6",fill:"#6abee4",children:(0,e.jsx)("animateTransform",{attributeName:"transform",type:"scale",begin:"-0.1146788990825688s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"0.9174311926605504s",repeatCount:"indefinite"})})}),(0,e.jsx)("g",{transform:"translate(80 50)",children:(0,e.jsx)("circle",{cx:"0",cy:"0",r:"6",fill:"#8ab9ff",children:(0,e.jsx)("animateTransform",{attributeName:"transform",type:"scale",begin:"0s",calcMode:"spline",keySplines:"0.3 0 0.7 1;0.3 0 0.7 1",values:"0;1;0",keyTimes:"0;0.5;1",dur:"0.9174311926605504s",repeatCount:"indefinite"})})})]})},qe=function(x){return(0,e.jsx)(Je.Z,z()({component:Qe},x))},_e=qe,ee=t(6377),Le=t(40238),ne=t(90494),en=Ze.Z.Panel,ln=We.ZP.useBreakpoint,nn=function(x){var C=x.defaultTarget,F=x.onClose,S=(0,ve.useModel)("chain"),y=S.chain,g=S.poolTokenExtList,B=S.updataTokens,I=S.wallet,O=(0,c.useState)(),xe=h()(O,2),te=xe[0],b=xe[1];if(g.length===0)return(0,e.jsx)(e.Fragment,{});(0,c.useEffect)(function(){var r=g.find(function(u){return u.id===C});r&&H(r)},[C]);var re=(0,c.useState)([{key:0,amount:"",amountUSD:"",precent:0,showSelect:!1,targetToken:void 0}]),ge=h()(re,2),N=ge[0],ae=ge[1],Me=function(){var u={key:new Date().getTime(),amount:"",amountUSD:"",precent:0,showSelect:!1,targetToken:void 0};ae([].concat(De()(N),[u]))},Z=(0,c.useState)("0"),oe=h()(Z,2),E=oe[0],W=oe[1],ye=(0,c.useState)("-"),V=h()(ye,2),ke=V[0],U=V[1],T=(0,c.useState)(!1),se=h()(T,2),pe=se[0],Y=se[1],le=function(){var r=q()(L()().mark(function u(){var d,n,o,a,i;return L()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!v||!y||!I)){s.next=2;break}return s.abrupt("return");case 2:if(d=[],N.forEach(function(f){f.targetToken&&f.amount&&d.push({amount:f.amount,targetToken:f.targetToken})}),d.length!==0){s.next=8;break}return W("0"),U("-"),s.abrupt("return");case 8:return Y(!0),s.next=11,(0,ee.xO)({chain:y,wallet:I,outToken:v,inTokenList:d,amountOut:Number(M)||0});case 11:n=s.sent,o=h()(n,2),a=o[0],i=o[1],Y(!1),a&&(W(a.limit),U(a.risk)),i&&_.ZP.error(i.error);case 18:case"end":return s.stop()}},u)}));return function(){return r.apply(this,arguments)}}(),G=(0,Le.Z)(le,{wait:1e3}),K=function(u,d,n){var o=N.map(function(a){if(a.key===u){var i=a;return i[d]=n,a.targetToken&&(d==="precent"&&(i.amount=(Number(a.targetToken.userTokenBalanceLabel)*n/100).toFixed()),d==="amount"&&(i.precent=Math.round(n/Number(a.targetToken.userTokenBalanceLabel)*100))),i}return a});ae(o),G.run()},ue=function(u){ae(N.filter(function(d){return d.key!==u})),G.run()},l=we.Z.useToken(),R=l.token,$=R.colorPrimary,Te=R.boxShadow,k=R.colorInfoBg,Se=R.colorBgContainer,Pe=R.colorText,j=R.colorTextSecondary,X=(0,c.useRef)(),ie=(0,c.useState)(null),ce=h()(ie,2),v=ce[0],H=ce[1],de=(0,c.useState)(""),fe=h()(de,2),M=fe[0],J=fe[1],je=(0,c.useState)(!1),P=h()(je,2),Ie=P[0],he=P[1],Ce=function(u){J(u),G.run()},Q=function(){var r=q()(L()().mark(function u(){var d,n,o,a,i;return L()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!y||!v||!I)){s.next=2;break}return s.abrupt("return");case 2:if(d=[],N.forEach(function(f){f.targetToken&&f.amount&&d.push({amount:f.amount,targetToken:f.targetToken})}),d.length!==0){s.next=6;break}return s.abrupt("return");case 6:return he(!0),s.next=9,(0,ee.sI)({chain:y,wallet:I,outToken:v,inTokenList:d,amountOut:Number(M)||0});case 9:if(n=s.sent,o=h()(n,2),a=o[0],i=o[1],!a){s.next=17;break}return b({show:!0,onClose:function(){b(void 0),F()},title:"Borrow success",type:"borrow",hash:a.hash,okText:"Close"}),s.next=17,B();case 17:i&&_.ZP.error(i.error),he(!1);case 19:case"end":return s.stop()}},u)}));return function(){return r.apply(this,arguments)}}();return(0,e.jsxs)(me.Z,{gutter:[10,10],children:[N.map(function(r){return(0,e.jsx)(w.Z,{span:"24",className:"cardWrap",children:(0,e.jsx)(ne.Z,{amount:Number(r.amount),tokenList:g,onAmountChange:function(d){K(r.key,"amount",d)},onTokenChange:function(d){return K(r.key,"targetToken",d)},currentToken:r.targetToken,maxValue:r.targetToken&&Number(r.targetToken.userTokenBalance)||0,header:r.targetToken?(0,e.jsxs)("div",{className:"label",children:[(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:j},children:["Pay(Collateral):$",(0,Re.Xs)(r.amount,r.targetToken.userOraclePriceLabel,0)]}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:j},onClick:function(){K(r.key,"amount",r.targetToken&&r.targetToken.userTokenBalance)},children:["Balance: ",(0,e.jsx)("span",{style:{color:$},children:Number(r.targetToken.userTokenBalance)})]})]}):"",idKey:r.key,showRemove:N.length>1,handleRemove:function(d){return ue(d)}})},r.key)}),(0,e.jsx)(w.Z,{span:24,className:"add",children:(0,e.jsx)(Ke.Z,{onClick:Me,style:{color:$}})}),(0,e.jsx)(w.Z,{span:"24",children:(0,e.jsx)(ne.Z,{amount:Number(M),tokenList:g,onAmountChange:function(u){Ce(u)},onTokenChange:function(u){return H(u)},currentToken:v,maxValue:Number(E)||0,header:v&&(0,e.jsxs)("div",{className:"label",children:[(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:j},onClick:function(){J(E),G.run()},children:["Borrow Limit :",pe?(0,e.jsx)(_e,{style:{color:$}}):(0,e.jsx)("span",{style:{color:$},children:E})]}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:j},children:["Borrowed: ",(0,e.jsx)("span",{style:{color:$},children:v&&Number(v?.userDebt).toFixed(4)})]})]})})}),(0,e.jsxs)(w.Z,{span:24,className:"tips",children:[(0,e.jsxs)("div",{className:"tip",children:[(0,e.jsx)(m.Z.Text,{style:{fontSize:12,color:j},children:"APR"}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:j},children:[v?.apr,"%"]})]}),(0,e.jsxs)("div",{className:"tip",children:[(0,e.jsx)(Be.Z,{title:"Your CDP gets liquidated when RF drops to <= 1.00",children:(0,e.jsx)(m.Z.Text,{underline:!0,style:{fontSize:12,color:j},children:"Risk Factor"})}),(0,e.jsx)(m.Z.Text,{style:{fontSize:12,color:j},children:ke})]})]}),(0,e.jsx)(w.Z,{span:"24",children:(0,e.jsx)(Ne.Z,{onClick:Q,loading:Ie,conditions:[{condition:!v,text:"Select Asset",type:"primary",onClick:function(){setShowSelect(!0)}},{condition:!M,text:"Enter Amount",type:"default",onClick:function(){X.current&&X.current.focus()}},{condition:E<M,text:"Exceeded max borrow amount",type:"primary",onClick:function(){X.current&&X.current.focus()}}],children:"Add Collateral and Borrow"})}),te&&(0,e.jsx)(Ae.Z,z()({},te))]})},tn=function(x){var C=x.defaultTarget,F=x.onClose,S=(0,ve.useModel)("chain"),y=S.chain,g=S.wallet,B=S.poolTokenExtList,I=S.updataTokens;if(!g||!y)return(0,e.jsx)(e.Fragment,{});var O=(0,ve.useIntl)(),xe=O.formatMessage,te=we.Z.useToken(),b=te.token,re=b.colorPrimary,ge=b.boxShadow,N=b.colorInfoBg,ae=b.colorBgContainer,Me=b.colorText,Z=b.colorTextSecondary,oe=b.colorErrorText,E=(0,c.useState)(!1),W=h()(E,2),ye=W[0],V=W[1],ke=(0,c.useState)(0),U=h()(ke,2),T=U[0],se=U[1],pe=(0,c.useState)(""),Y=h()(pe,2),le=Y[0],G=Y[1],K=(0,c.useState)(),ue=h()(K,2),l=ue[0],R=ue[1],$=(0,c.useState)([]),Te=h()($,2),k=Te[0],Se=Te[1],Pe=(0,c.useState)(!1),j=h()(Pe,2),X=j[0],ie=j[1],ce=(0,c.useState)(),v=h()(ce,2),H=v[0],de=v[1],fe=(0,c.useState)(),M=h()(fe,2),J=M[0],je=M[1];(0,c.useEffect)(function(){var n=B.find(function(o){return o.id===C});n&&R(n)},[C]),(0,c.useEffect)(function(){if(l){var n=l.positions.collaterals,o=[];n.forEach(function(a){var i=B.find(function(p){return p.id.toLowerCase()===a.token.toLowerCase()});console.log(i),i&&a.amount&&o.push({token:i,max:Number((0,Re.gB)(a.amount,i.tokenDecimal))||0,amount:0})}),console.log(o),Se(o)}},[l]);var P=(0,c.useMemo)(function(){return l?{label:"Max payable",value:l.userDebt}:{label:"Max payable",value:0}},[l]),Ie=(0,c.useMemo)(function(){return l&&T?(Number(T)*Number(l.userOraclePrice)).toFixed().replace(/\B(?=(\d{3})+(?!\d))/g,","):""},[l,T]),he=(0,c.useCallback)(q()(L()().mark(function n(){var o,a,i,p;return L()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!l||!y||!g)){f.next=2;break}return f.abrupt("return");case 2:return ie(!0),f.next=5,(0,ee._p)({amountIn:T,tokenIn:l,tokenOuts:k,chain:y,wallet:g});case 5:if(o=f.sent,a=h()(o,2),i=a[0],p=a[1],ie(!1),!p){f.next=13;break}return _.ZP.error(p.error),f.abrupt("return");case 13:i&&je(i);case 14:case"end":return f.stop()}},n)})),[y,g,l,T]),Ce=(0,Le.Z)(he,{wait:500}),Q=Ce.run,r=function(o){se(o),Q()},u=function(o,a,i){var p=k.map(function(s){if(s.token.id===o){var f=s;return f[a]=i,f}return s});Se(p),Q()},d=function(){var n=q()(L()().mark(function o(){var a,i,p,s;return L()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(l){A.next=2;break}return A.abrupt("return");case 2:return V(!0),A.next=5,(0,ee.S4)({chain:y,wallet:g,amountIn:T,tokenOuts:k,tokenIn:l});case 5:if(a=A.sent,i=h()(a,2),p=i[0],s=i[1],!p){A.next=13;break}return de({show:!0,onClose:function(){de(void 0),F()},title:"Repay success",type:"repay",hash:p.hash,okText:"Close"}),A.next=13,I();case 13:s&&_.ZP.error(s.error),V(!1);case 15:case"end":return A.stop()}},o)}));return function(){return n.apply(this,arguments)}}();return(0,e.jsx)(Ve.Z,{spinning:ye,children:(0,e.jsxs)("div",{className:"hayMarginWrap",children:[(0,e.jsx)(ne.Z,{amount:T,currentToken:l,tokenList:B,onAmountChange:r,onTokenChange:function(o){R(o),Q()},header:l&&(0,e.jsxs)("div",{className:"label",children:[(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:Z},onClick:function(){return r(Number(P.value))},children:[P.label,": ",(0,e.jsxs)("span",{style:{color:re},children:[P.value," ",l.symbol]})]}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12},onClick:function(){return r(Number(P.value))},children:["Wallet Bal: ",(0,e.jsx)("span",{children:l.userTokenBalanceLabel})]})]}),maxValue:Number(P.value)||0}),k.length>1&&(0,e.jsx)("div",{className:"collapseWrap",style:{background:N,borderRadius:8,marginTop:10},children:(0,e.jsx)(Ze.Z,{defaultActiveKey:["1"],ghost:!0,children:(0,e.jsx)(en,{header:"Collateral",children:(0,e.jsx)(Ue.Z,{children:k.map(function(n){return(0,e.jsxs)(Ye.Z,{type:"default",style:{border:"none",display:"flex",alignItems:"center",justifyContent:"center",height:35},icon:(0,e.jsx)(Xe.Z,{size:25,src:n.token.icon,tokenId:n.token.id}),children:[" ",(0,e.jsx)("span",{style:{marginLeft:4},children:n.token.symbol}),"  "]},n.token.id)})})},"1")})}),k.length===1&&[k[0]].map(function(n){return(0,e.jsx)("div",{style:{marginTop:10},children:(0,e.jsx)(ne.Z,{amount:n.amount,currentToken:n.token,tokenList:B,onAmountChange:function(a){return u(n.token.id,"amount",a)},onTokenChange:function(a){u(n.token.id,"token",a)},header:n.token&&(0,e.jsxs)("div",{className:"label",children:[(0,e.jsxs)(m.Z.Text,{style:{fontSize:12},onClick:function(){return u(n.token.id,"amount",n.max)},children:["Withdraw: $",(0,e.jsx)("span",{children:Number(n.token.userBorrowPrice)*n.amount})]}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:Z},onClick:function(){return u(n.token.id,"amount",n.max)},children:["Max withdraw: ",(0,e.jsxs)("span",{style:{color:re},children:[n.max," "]})]})]}),maxValue:Number(n.max)||0,canSelectToken:!1})},n.token.id)}),(0,e.jsxs)("div",{className:"tips",children:[(0,e.jsxs)("div",{className:"tip",children:[(0,e.jsx)(m.Z.Text,{style:{fontSize:12,color:Z},children:"APR"}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:Z},children:[l?.apr,"%"]})]}),(0,e.jsxs)("div",{className:"tip",children:[(0,e.jsx)(m.Z.Text,{style:{fontSize:12,color:Z},children:"Debt"}),(0,e.jsxs)(m.Z.Text,{style:{fontSize:12,color:Z},children:[l?.userDebt," ",l?.symbol]})]}),(0,e.jsxs)("div",{className:"tip",children:[(0,e.jsx)(Be.Z,{title:"Your CDP gets liquidated when RF drops to <= 1.00",children:(0,e.jsx)(m.Z.Text,{underline:!0,style:{fontSize:12,color:Z},children:"Risk Factor"})}),(0,e.jsx)(m.Z.Text,{style:{fontSize:12,color:parseFloat(J)>=1?Z:oe},children:J})]})]}),(0,e.jsx)(Ne.Z,{height:50,onClick:d,conditions:[{condition:!!le,text:le,type:"default",onClick:function(){}},{condition:!T&&k.length>1||!T&&k.length===1&&!k[0].amount,text:"Input Amount",type:"primary",onClick:function(){}},{condition:!T&&k.length===1&&!!k[0].amount,text:"Remove collaterall",type:"primary",onClick:d}],children:"Repay"}),H&&(0,e.jsx)(Ae.Z,z()({},H))]})})},rn=function(x){var C=x.defaultAction,F=x.defaultTarget,S=(0,c.useState)(),y=h()(S,2),g=y[0],B=y[1];return(0,c.useEffect)(function(){B(C)},[C]),(0,e.jsxs)(me.Z,{gutter:[10,10],className:"Borrow-Comp",children:[(0,e.jsx)(w.Z,{span:"24",children:(0,e.jsx)(Ge.Z,{style:{width:"100%"},value:g,onChange:function(O){return B(O)},block:!0,options:[{label:(0,e.jsx)("div",{style:{padding:4},className:"SegmentedWrap",children:(0,e.jsx)("div",{children:"Borrow/Add Coll."})}),value:"borrow"},{label:(0,e.jsx)("div",{style:{padding:4},className:"SegmentedWrap",children:(0,e.jsx)("div",{children:"Remove Coll./Repay"})}),value:"repay"}]})}),(0,e.jsx)(w.Z,{span:"24",style:{overflow:"hidden"},children:(0,e.jsxs)(me.Z,{wrap:!1,gutter:[20,20],children:[(0,e.jsx)(w.Z,{span:"24",style:{display:g==="borrow"?"block":"none"},children:(0,e.jsx)(nn,z()({},x))}),(0,e.jsx)(w.Z,{span:"24",style:{display:g==="repay"?"block":"none"},children:(0,e.jsx)(tn,z()({},x))})]})})]})},an=function(x){var C=x.show,F=x.onClose;return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(He.Z,{show:C,onClose:F,children:(0,e.jsx)(rn,z()({},x))})})},on=an}}]);
