"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2933],{22933:function(ut,ne,a){a.r(ne),a.d(ne,{default:function(){return De}});var je=a(97857),G=a.n(je),Le=a(15009),A=a.n(Le),w=a(99289),ae=a.n(w),Ne=a(19632),re=a.n(Ne),Pe=a(5574),m=a.n(Pe),H=a(92195),O=a(27790),ke=a(71230),s=a(15746),z=a(7075),be=a(12699),T=a(21035),u=a(67294),b=a(41687),se=a(41375),J=a(6377),Ie=a(40238),ie=a(90494),t=a(85893),Q=function(F){var de=F.setCurrentChart,g=F.isLong,Ze=F.setCurrentChartPair,me=(0,u.useState)(),R=m()(me,2),o=R[0],Z=R[1],Me=(0,u.useState)(),v=m()(Me,2),r=v[0],S=v[1],fe=(0,u.useState)(""),M=m()(fe,2),N=M[0],B=M[1],$e=(0,u.useState)(""),he=m()($e,2),I=he[0],V=he[1],ve=(0,u.useState)(""),ge=m()(ve,2),X=ge[0],Y=ge[1],xe=(0,u.useState)(!1),Ce=m()(xe,2),Ae=Ce[0],E=Ce[1],f=(0,b.useModel)("chain"),c=f.poolTokenExtList,oe=f.osdData,q=f.chain,U=f.wallet,Fe=f.updataTokens,Ve=(0,b.useModel)("future"),D=Ve.tokenPairs,Be=Ve.positionList,ct=(0,b.useModel)("initModel"),Bt=ct.maxSlippage,dt=(0,u.useState)(),Ee=m()(dt,2),l=Ee[0],mt=Ee[1],ft=(0,u.useState)(),Ge=m()(ft,2),le=Ge[0],ht=Ge[1],vt=(0,u.useState)("market"),Ke=m()(vt,2),p=Ke[0],Ue=Ke[1],gt=(0,u.useState)(1),We=m()(gt,2),Se=We[0],xt=We[1],Ct=(0,u.useState)(),He=m()(Ct,2),j=He[0],Je=He[1],wt=(0,u.useRef)(),St=(0,u.useState)(),Qe=m()(St,2),we=Qe[0],_=Qe[1],Tt=(0,u.useState)(0),Xe=m()(Tt,2),y=Xe[0],Oe=Xe[1],pt=(0,u.useState)(0),Ye=m()(pt,2),qe=Ye[0],_e=Ye[1],yt=(0,u.useState)(0),et=m()(yt,2),tt=et[0],nt=et[1],jt=(0,u.useState)(!1),at=m()(jt,2),rt=at[0],Lt=at[1],Nt=(0,b.useIntl)(),Te=Nt.formatMessage,L=(0,u.useMemo)(function(){return oe?[].concat(re()(c),[oe]):c},[c,oe]),Pt=(0,u.useMemo)(function(){if(D.length>0&&L.length>0){var n=D;r&&(n=n.filter(function(i){return i.indexToken.toLowerCase()===r.id.toLowerCase()}));var e=n.map(function(i){return i.collateralToken.toLowerCase()});return L.filter(function(i){return e.includes(i.id.toLowerCase())})}return[]},[L,D,r]),kt=(0,u.useMemo)(function(){if(D.length>0&&L.length>0){var n=D;o&&(n=n.filter(function(i){return i.collateralToken.toLowerCase()===o.id.toLowerCase()}));var e=n.map(function(i){return i.indexToken.toLowerCase()});return L.filter(function(i){return e.includes(i.id.toLowerCase())})}return[]},[L,D,o]);(0,u.useEffect)(function(){if(L.length>0&&D.length>0&&Be.length>0){var n=o,e=r;if(!n&&!e&&(n=L.find(function(h){return h.id.toLowerCase()===D[0].collateralToken.toLowerCase()}),e=L.find(function(h){return h.id.toLowerCase()===D[0].indexToken.toLowerCase()})),n&&e){var i=Be.find(function(h){return h.collateralToken.toLowerCase()===n.id.toLocaleLowerCase()&&h.indexToken.toLowerCase()===e.id.toLowerCase()&&h.isLong===g}),C=D.find(function(h){return h.collateralToken.toLowerCase()===n.id.toLocaleLowerCase()&&h.indexToken.toLowerCase()===e.id.toLowerCase()});i&&ht(i),C&&(mt(C),Ze(C)),o||Z(n),r||S(e)}}},[L,D,Be,o,r]),(0,u.useEffect)(function(){if(o){var n=L.find(function(i){return i.id===o.id});Z(n)}if(r){var e=L.find(function(i){return i.id===r.id});S(e)}},[L]),(0,u.useEffect)(function(){l&&Oe(Number(l.userIndexPrice))},[l]);var bt=H.Z.useToken(),ee=bt.token,pe=ee.colorPrimary,Ot=ee.boxShadow,zt=ee.colorInfoBg,Rt=ee.colorBgContainer,Vt=ee.colorText,te=ee.colorTextSecondary,st=(0,u.useMemo)(function(){if(N&&l)return Number(N)*Number(l.userCollateralPrice)},[N,l,p,y]),It=(0,u.useMemo)(function(){if(I&&r)return(Number(I)*Number(p==="market"?r.userOraclePrice:y)).toFixed(2)},[I,r,p,y]),Et=(0,u.useMemo)(function(){if(r&&c.length>0){if(r.symbol==="OSD"&&o){var n=c.find(function(i){return i.id===o.id});if(n)return n.poolOsd}var e=c.find(function(i){return i.id===r.id});if(e)return e.poolReserve}else return"-"},[r,o]),Dt=function(){var n=ae()(A()().mark(function e(){var i,C,h,$,P,k;return A()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(console.log(l,le),!(!r||!o||!q||!Number(N)||!l||!le)){x.next=3;break}return x.abrupt("return");case 3:if(i=(0,J.Kj)({curPair:l,curPosition:le,amount:String(N),type:"in",tradeType:p,leverage:Se,targetPrice:String(y)}),C=m()(i,2),h=C[0],$=h.size,P=h.curData,k=C[1],!k){x.next=7;break}return O.ZP.error(k.error),x.abrupt("return");case 7:V($),P&&(console.log(P,"_curData_curData_curData"),Je(P)),Y("in");case 10:case"end":return x.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),Zt=(0,Ie.Z)(Dt,{wait:500}),ue=Zt.run,Mt=function(){var n=ae()(A()().mark(function e(){var i,C,h,$,P,k;return A()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!(!r||!o||!q||!Number(I)||!l||!le||!Se)){x.next=2;break}return x.abrupt("return");case 2:if(i=(0,J.Kj)({curPair:l,curPosition:le,amount:String(I),type:"out",tradeType:p,leverage:Se,targetPrice:String(y)}),C=m()(i,2),h=C[0],$=h.size,P=h.curData,k=C[1],console.log(k,$),!k){x.next=7;break}return O.ZP.error(k.error),x.abrupt("return");case 7:B($),P&&(console.log(P),Je(P)),Y("out");case 10:case"end":return x.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),$t=(0,Ie.Z)(Mt,{wait:500}),ye=$t.run,it=function(e,i){i==="in"?(r?.id===e.id&&S(void 0),Z(e),ue()):(o?.id===e.id&&Z(void 0),S(e),de(e),N?ue():ye())},At=function(){var n=ae()(A()().mark(function e(){var i,C,h,$,P,k,W,x,ot,ze,ce,Re;return A()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(!q||!U||!j||!o||!I||!N||!r||!l)){d.next=2;break}return d.abrupt("return");case 2:if(E(!0),p!=="market"){d.next=17;break}return d.next=6,(0,J.tu)({chain:q,wallet:U,inToken:o,outToken:r,isLong:g,marginDelta:j.marginDelta,_notionalDelta:j.notionalDelta});case 6:if(i=d.sent,C=m()(i,2),h=C[0],$=C[1],$&&O.ZP.error($.error),!h){d.next=15;break}return _({type:"openLong",show:!0,onClose:function(){_(void 0),B(0),V(0)},title:"Opne  Success",hash:h?.hash||"",okText:"Close"}),d.next=15,Fe();case 15:d.next=49;break;case 17:if(rt){d.next=35;break}return d.next=20,(0,J.IH)({chain:q,wallet:U,targetPrice:String(y),inToken:o,outToken:r,curPair:l,isLong:g,notionalDelta:j.notionalDelta,marginDelta:j.marginDelta});case 20:if(P=d.sent,k=m()(P,2),W=k[0],x=k[1],!x){d.next=28;break}return O.ZP.error(x.error),E(!1),d.abrupt("return");case 28:if(!W){d.next=33;break}return _({type:"openLong",show:!0,onClose:function(){_(void 0),B(0),V(0),Oe(0)},title:"Opne  Success",hash:W?.hash||"",okText:"Close"}),console.log("updataTokensupdataTokensupdataTokensupdataTokens"),d.next=33,Fe();case 33:d.next=49;break;case 35:return d.next=37,(0,J.mE)({chain:q,wallet:U,targetPrice:String(y),inToken:o,outToken:r,curPair:l,isLong:g,notionalDelta:j.notionalDelta,marginDelta:j.marginDelta,tpPrice:qe,slPrice:tt});case 37:if(ot=d.sent,ze=m()(ot,2),ce=ze[0],Re=ze[1],!Re){d.next=45;break}return O.ZP.error(Re.error),E(!1),d.abrupt("return");case 45:if(!ce){d.next=49;break}return _({type:"openLong",show:!0,onClose:function(){_(G()(G()({},we),{},{show:!1})),B(0),V(0)},title:"Opne  Success",hash:ce?.hash||"",okText:"Close"}),d.next=49,Fe();case 49:E(!1);case 50:case"end":return d.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),Ft={slPrice:tt,setSlPrice:nt,tpPrice:qe,setTpPrice:_e,tpsl:rt,setTPSL:function(e){if(Lt(e),e){var i=Number((y*1.1).toFixed(2)),C=Number((y*.9).toFixed(2));_e(g?i:C),nt(g?C:i)}},setLeverage:function(e){xt(e),X==="in"&&ue(),X==="out"&&ye()},targetPrice:y,amountOut:Number(I),isLong:g,tradeType:p,cost:Number(st)};return(0,t.jsxs)(ke.Z,{className:"hay-swap",gutter:[4,4],children:[(0,t.jsxs)("div",{className:"tradeTypes",children:[(0,t.jsx)("span",{className:p==="market"?"active":"",onClick:function(){Ue("market")},children:"Market"}),(0,t.jsx)("span",{className:p==="limit"?"active":"",onClick:function(){Ue("limit")},children:"Limit"})]}),(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsx)(ie.Z,{header:o&&(0,t.jsxs)("div",{className:"label",children:[(0,t.jsxs)(z.Z.Text,{style:{fontSize:12,color:te},onClick:function(){},children:["Pay(Margin+Fee):  ",(0,t.jsxs)("span",{style:{color:pe},children:["$",st]})]}),(0,t.jsxs)(z.Z.Text,{style:{fontSize:12,color:te},onClick:function(){B(o.userTokenBalance),ue()},children:["Balance: ",(0,t.jsx)("span",{style:{color:pe},children:o.userTokenBalance})]})]}),amount:Number(N)||0,onAmountChange:function(e){B(e),ue()},maxValue:o?Number(o.userTokenBalance):0,currentToken:o,onTokenChange:function(e){return it(e,"in")},tokenList:Pt})}),(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsx)(ie.Z,{header:r&&(0,t.jsxs)("div",{className:"label",children:[(0,t.jsxs)(z.Z.Text,{style:{fontSize:12,color:g?"#00a980":"#eb5757"},onClick:function(){},children:[" ",g?"long":"short",": $",It]}),p==="market"&&(0,t.jsxs)(z.Z.Text,{style:{fontSize:12,color:te},children:["Market Price:  ",(0,t.jsx)("span",{style:{color:pe},children:l&&l.userIndexPrice})]})]}),amount:Number(I),onAmountChange:function(e){V(e),ye()},showSlider:!1,maxValue:1/0,currentToken:r,onTokenChange:function(e){return it(e,"out")},tokenList:kt})}),p==="limit"&&(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsx)(ie.Z,{header:r&&(0,t.jsxs)("div",{className:"label",children:[(0,t.jsx)(z.Z.Text,{style:{fontSize:12,color:te},onClick:function(){},children:" Price"}),(0,t.jsxs)(z.Z.Text,{style:{fontSize:12,color:te},children:["Market Price:  ",(0,t.jsx)("span",{style:{color:pe},children:l&&l.userIndexPrice})]})]}),amount:Number(y)||0,onAmountChange:function(e){Oe(e),ye()},minValue:g?0:Number(l&&l.userIndexPrice),maxValue:g?Number(l&&l.userIndexPrice):1/0,showSelectToken:!1,showSlider:g})}),(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsx)(se.default,G()({maxLeverage:l&&l.userMaxLeverage||1,leverage:Se},Ft))}),(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsxs)("div",{className:"InputCardTips",style:{color:te,fontSize:13},children:[(0,t.jsxs)("div",{className:"InputCardTip",children:[(0,t.jsx)("span",{className:"lable",children:Te({id:"entry_price"})}),(0,t.jsxs)("span",{className:"fee",children:["$",p==="market"?l&&l.userIndexPrice:y]})]}),p==="market"&&(0,t.jsxs)("div",{className:"InputCardTip",children:[(0,t.jsx)("span",{className:"lable",children:Te({id:"liquidation_price"})}),(0,t.jsx)("span",{className:"value",children:j&&"$".concat(j.liqPrice)})]}),p==="market"&&(0,t.jsxs)("div",{className:"InputCardTip",children:[(0,t.jsx)("span",{className:"lable",children:Te({id:"funding_rate"})}),(0,t.jsxs)("span",{className:"value",children:[j&&j._hourFundingRate,"%/1h"]})]}),(0,t.jsxs)("div",{className:"InputCardTip",children:[(0,t.jsx)("span",{className:"label",children:"Fees"}),j&&(0,t.jsxs)("span",{className:"value",children:[j._tradingFeeRate,"% (",j._tradingFee,o&&o.symbol,")"]})]})]})}),(0,t.jsx)(s.Z,{span:"24",children:(0,t.jsxs)(be.Z,{onClick:At,loading:Ae,wrapClassName:g?"long":"short",className:g?"long":"short",conditions:[{condition:!(U!=null&&U.isConnected),text:"Connect Wallet",type:"primary",onClick:function(){O.ZP.error("Connect Wallet")}},{condition:!o||!r,text:"Select Asset",type:"primary",onClick:function(){}},{condition:!N||!I,text:"Enter Amount",type:"primary",onClick:function(){}},{condition:!!o&&N>o.userTokenBalance,text:"Low balance",type:"primary",onClick:function(){}},{condition:p==="limit"&&!!l&&!!y&&(g&&Number(y)>=Number(l.userIndexPrice)||!g&&Number(y)<=Number(l.userIndexPrice)),text:Te({id:"Invalid Limit Price"}),type:"primary",onClick:function(){}}],children:["Open ",g?"Long":"Short"]})}),we&&(0,t.jsx)(T.Z,G()({},we))]})},De=Q},41375:function(ut,ne,a){a.r(ne),a.d(ne,{default:function(){return be}});var je=a(97857),G=a.n(je),Le=a(5574),A=a.n(Le),w=a(67294),ae=a(92195),Ne=a(32808),re=a(43262),Pe=a(72269),m=a(98225),H=a(7075),O=a(47729),ke=a(41687),s=a(85893);function z(T){var u=ae.Z.useToken(),b=u.token,se=b.colorPrimary,J=b.boxShadow,Ie=b.colorInfoBg,ie=b.colorBgContainer,t=b.colorText,Q=b.colorTextSecondary,De=(0,ke.useIntl)(),K=De.formatMessage,F=T.maxLeverage,de=T.leverage,g=T.setLeverage,Ze=T.setTPSL,me=T.tpsl,R=T.tpPrice,o=T.setTpPrice,Z=T.slPrice,Me=T.setSlPrice,v=T.targetPrice,r=T.isLong,S=T.amountOut,fe=T.tradeType,M=T.cost,N=(0,w.useState)(!1),B=A()(N,2),$e=B[0],he=B[1],I=(0,w.useState)(de),V=A()(I,2),ve=V[0],ge=V[1],X=(0,w.useMemo)(function(){var f=0,c=0;return S!==0&&(f=r?(R-v)*S:(v-R)*S,c=f/M*100),{rate:Number(c.toFixed(2))+"%",priceRate:Number(((R-v)/v*100).toFixed(2))+"%",amount:Number(f.toFixed(2))}},[R,v,S,r,M]),Y=(0,w.useMemo)(function(){var f=0,c=0;return S!==0&&(f=r?(v-Z)*S:(Z-v)*S,c=f/M*100),{rate:Number(c.toFixed(2))+"%",priceRate:Number(((v-Z)/v*100).toFixed(2))+"%",amount:Number(f.toFixed(2))}},[Z,v,S,r,M]),xe=(0,w.useMemo)(function(){if(!!S)return r?Number(v-M/S).toFixed(2):Number(Number(v)+M/S).toFixed(2)},[v,M,S,r]),Ce=function(c){Ze(c.target.checked)},Ae=function(c){he(c)},E=function(c){console.log(c),ge(c),g(c)};return(0,w.useEffect)(function(){F<de&&E(F)},[F]),(0,s.jsxs)("div",{className:"hayTPSL",children:[(0,s.jsxs)("div",{className:"tpsl row",children:[fe==="limit"?(0,s.jsxs)("div",{className:"tpsl",children:["TP/SL ",(0,s.jsx)(Ne.Z,{onChange:Ce,checked:me,className:"checkbox"})]}):(0,s.jsx)("div",{className:"tpsl"}),(0,s.jsxs)("div",{className:"silder_trigger",children:[(0,s.jsx)("div",{children:(0,s.jsx)(re.Z,{value:ve,onChange:E,min:1,max:F||1,className:"dig"})}),(0,s.jsx)("span",{className:"txt",children:"slider"}),(0,s.jsx)(Pe.Z,{onChange:Ae})]})]}),$e&&(0,s.jsx)(O.Z,{className:"slider",thumbClassName:"thumb",trackClassName:"track",onChange:function(c){return E(c)},value:ve,min:1,max:F||1,renderThumb:function(c,oe){return(0,s.jsx)("div",G()(G()({},c),{},{children:(0,s.jsxs)("div",{className:"thumbInner",style:{background:t,color:ie},children:[oe.valueNow,".00x"]})}))}}),fe==="limit"&&me&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(m.Z,{className:"hayInputCard",bodyStyle:{padding:0},style:{border:"0.5px solid "+se,marginBottom:10,marginTop:10},children:[(0,s.jsxs)("div",{className:"label",children:[(0,s.jsxs)(H.Z.Text,{style:{fontSize:12,color:Q},onClick:function(){},children:[K({id:"tp_price"}),"(",X.priceRate," ",K({id:"up"}),")"]}),(0,s.jsx)(H.Z.Text,{style:{fontSize:12,color:Q},onClick:function(){},children:K({id:"estimated_profit"})})]}),(0,s.jsxs)("div",{className:"value",children:[(0,s.jsx)(re.Z,{className:"inputTxt",value:R,onChange:o,min:r?v:0,max:r?1/0:v,formatter:function(c){return"$ ".concat(c).replace(/\B(?=(\d{3})+(?!\d))/g,",")},bordered:!1,controls:!1}),(0,s.jsxs)("div",{className:"amount_green",style:{color:se},children:["$",X.amount,"(",X.rate,")"]})]})]}),(0,s.jsxs)(m.Z,{className:"hayInputCard",bodyStyle:{padding:0},style:{border:"0.5px solid "+se,marginBottom:10,marginTop:10},children:[(0,s.jsxs)("div",{className:"label",children:[(0,s.jsxs)(H.Z.Text,{style:{fontSize:12,color:Q},onClick:function(){},children:[K({id:"tigger_price"}),"(",Y.priceRate," ",K({id:"down"}),")"]}),(0,s.jsx)(H.Z.Text,{style:{fontSize:12,color:Q},onClick:function(){},children:K({id:"estimated_loss"})})]}),(0,s.jsxs)("div",{className:"value",children:[(0,s.jsx)(re.Z,{className:"inputTxt",value:Z,onChange:Me,min:r?xe:v,max:r?v:xe,formatter:function(c){return"".concat(r?"\u2264":"\u2265"," $ ").concat(c).replace(/\B(?=(\d{3})+(?!\d))/g,",")},bordered:!1,controls:!1}),(0,s.jsxs)("div",{className:"amount_green shortColor",children:["$",Y.amount,"(",Y.rate,")"]})]})]})]})]})}var be=z}}]);
