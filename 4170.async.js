"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4170],{30436:function(Be,$,e){e.r($),e.d($,{default:function(){return d}});var le=e(13769),j=e.n(le),A=e(97857),g=e.n(A),de=e(15009),O=e.n(de),H=e(99289),S=e.n(H),C=e(5574),s=e.n(C),y=e(67294),_=e(75302),I=e(71230),l=e(15746),x=e(92195),N=e(27790),Te=e(57953),T=e(7075),E=e(31530),K=e(41687),ue=e(87603),F=e(12699),ee=e(93417),ce=e(66419),t=e(6377),Pe=e(21035),Y=e(90494),n=e(85893),ne=["defaultAction"],he=["show","onClose"],te=_.ZP.useBreakpoint,o=function(r){var a=r.label,h=r.children;return(0,n.jsxs)(I.Z,{className:"InputCardTip",style:{fontSize:13},children:[(0,n.jsx)(l.Z,{children:a}),(0,n.jsx)(l.Z,{children:h})]})},c=function(r){var a=r.currentPostion,h=r.actionType,P=(0,K.useModel)("chain"),m=P.chain,J=P.wallet,L=(0,K.useModel)("future"),ve=L.updatePositions,k=L.setPairsLoading,xe=(0,K.useIntl)(),me=xe.formatMessage,ke=a.userMargin,ge=a.collateralTokenObj,se=a.indexTokenObj,Ze=a.isLong,Q=a.pair,De=a.userLiqPrice,fe=a.size,Re=a.userSize;if(!ge||!se||!Q||!m||!J)return(0,n.jsx)(n.Fragment,{});var ze=ge.userTokenBalance,D=(0,y.useState)(!1),pe=s()(D,2),$e=pe[0],re=pe[1],Me=(0,y.useState)(0),je=s()(Me,2),V=je[0],Ie=je[1],R=(0,y.useState)(""),Le=s()(R,2),Ae=Le[0],Se=Le[1],Ne=x.Z.useToken(),w=Ne.token,Ce=w.colorInfoBg,G=w.colorTextSecondary,Oe=(0,y.useState)(),q=s()(Oe,2),u=q[0],Z=q[1],W=(0,y.useState)(),p=s()(W,2),ye=p[0],ae=p[1],oe=(0,y.useMemo)(function(){return h==="close"?Re:"0"},[h]);(0,y.useEffect)(function(){var M=(0,t.oD)({currentPostion:a,amountIn:String(V)}),U=s()(M,2),v=U[0],z=U[1];if(z){console.log(z.error),Se(z.error);return}v&&Z(v),Se("")},[a,V]);var ie=function(U){Ie(U)},be=function(){var M=S()(O()().mark(function U(){var v,z,Ee,Fe;return O()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return re(!0),X.next=3,(0,t.O0)({chain:m,wallet:J,isLong:Ze,amountIn:V,currentPosition:a});case 3:if(v=X.sent,z=s()(v,2),Ee=z[0],Fe=z[1],!Fe){X.next=11;break}return N.ZP.error(Fe.error),re(!1),X.abrupt("return");case 11:return Ee&&ae({show:!0,onClose:function(){ae(void 0)},type:"closePosition",title:"Close Position Success",hash:Ee.hash,okText:"Close"}),k(!0),X.next=15,ve();case 15:re(!1);case 16:case"end":return X.stop()}},U)}));return function(){return M.apply(this,arguments)}}();return(0,n.jsxs)(Te.Z,{spinning:$e,children:[(0,n.jsxs)(I.Z,{gutter:[10,10],className:"hayMarginWrap",children:[(0,n.jsx)(l.Z,{span:24,className:"card",children:(0,n.jsx)(Y.Z,{tokenList:[],currentToken:se,onTokenChange:function(){},canSelectToken:!1,amount:V,onAmountChange:ie,minValue:0,maxValue:Number(oe),header:(0,n.jsxs)("div",{className:"label",children:[(0,n.jsxs)(T.Z.Text,{style:{fontSize:12,color:G},children:[me({id:"close"})," ",Ze?"Long":"Short",": $",(0,ce.Ce)(V,Number(Q.userIndexPrice))]}),(0,n.jsxs)(T.Z.Text,{style:{fontSize:12,color:G},children:[me({id:"position_size"}),":\xA0",(0,n.jsx)("span",{className:"primary",onClick:function(){return ie(Number(oe))},children:oe})]})]})})}),(0,n.jsx)(l.Z,{span:24,className:"card",children:(0,n.jsxs)("div",{className:"hayInputCard",style:{background:Ce},children:[(0,n.jsxs)("div",{className:"label",children:[(0,n.jsx)(T.Z.Text,{style:{fontSize:12,color:G},children:" Price"}),(0,n.jsxs)(T.Z.Text,{style:{fontSize:12,color:G},children:["Mark:",Q.userIndexPrice,"  "]})]}),(0,n.jsxs)("div",{className:"value",children:[(0,n.jsxs)(T.Z.Text,{style:{fontSize:24,fontWeight:500},children:[" ",Q.userIndexPrice]}),(0,n.jsx)(T.Z.Text,{style:{fontSize:24,fontWeight:500},children:" USD"})]})]})}),(0,n.jsx)(l.Z,{span:24,children:u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o,{label:"PnL/ROE",children:(0,n.jsxs)(T.Z.Text,{className:u.isPositive?"linkColor":"shortColor",children:[u.pnlStr,"/",u.roeStr]})}),(0,n.jsx)(o,{label:"Leverage",children:u.leverage}),(0,n.jsxs)(o,{label:"Margin",children:[ke," ",(0,n.jsx)(ue.Z,{}),"  $",u.leftMargin]}),(0,n.jsx)(o,{label:"Margin Rate",children:u.mr}),(0,n.jsxs)(o,{label:"EST Liquidation Price",children:["$",u.liqPrice]}),(0,n.jsx)(o,{label:"Receive",children:(0,n.jsxs)(T.Z.Text,{className:u.isPositive?"linkColor":"shortColor",children:[u.receive," In ",ge.symbol]})})]})}),(0,n.jsx)(l.Z,{span:24,children:(0,n.jsx)(F.Z,{height:50,onClick:be,conditions:[{condition:!!Ae,text:Ae,type:"default",onClick:function(){}},{condition:!V,text:"Enter Amount",type:"default",onClick:function(){}}],children:"Close Position"})})]}),ye&&(0,n.jsx)(Pe.Z,g()({},ye))]})},f=function(){return _jsx(Row,{gutter:[10,10],children:"Rem,ove"})},B=function(r){var a=r.defaultAction,h=j()(r,ne),P=(0,y.useState)(),m=s()(P,2),J=m[0],L=m[1];return(0,y.useEffect)(function(){L(a)},[a]),(0,n.jsxs)(I.Z,{gutter:[10,10],className:"Borrow-Comp",children:[(0,n.jsx)(l.Z,{span:"24",children:(0,n.jsx)(E.Z,{style:{width:"100%"},value:J,onChange:function(k){return L(k)},block:!0,options:[{label:(0,n.jsx)("div",{style:{padding:4},children:(0,n.jsx)("div",{children:"TP/SL"})}),value:"tpsl",disabled:!0},{label:(0,n.jsx)("div",{style:{padding:4},children:(0,n.jsx)("div",{children:"Close Position"})}),value:"close"}]})}),(0,n.jsx)(l.Z,{span:"24",style:{overflow:"hidden"},children:(0,n.jsxs)(I.Z,{wrap:!1,gutter:[20,20],style:{transform:"translateX(".concat(J==="tpsl"?"0":"-100","%)"),transition:"transform .4s ease-in-out"},children:[(0,n.jsx)(l.Z,{span:"24",children:(0,n.jsx)(c,g()(g()({},g()({},h)),{},{actionType:"tpsl"}))}),(0,n.jsx)(l.Z,{span:"24",children:(0,n.jsx)(c,g()(g()({},g()({},h)),{},{actionType:"close"}))})]})})]})},b=function(r){var a=r.show,h=r.onClose,P=j()(r,he);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ee.Z,{show:a,onClose:h,closable:!0,maskClosable:!1,title:"Colse Position",children:(0,n.jsx)(B,g()({},P))})})},d=b},79886:function(Be,$,e){e.r($),e.d($,{default:function(){return he}});var le=e(97857),j=e.n(le),A=e(15009),g=e.n(A),de=e(99289),O=e.n(de),H=e(5574),S=e.n(H),C=e(67294),s=e(75302),y=e(92195),_=e(27790),I=e(71230),l=e(15746),x=e(57953),N=e(7075),Te=e(31530),T=e(41687),E=e(87603),K=e(12699),ue=e(93417),F=e(6377),ee=e(90494),ce=e(21035),t=e(85893),Pe=s.ZP.useBreakpoint,Y=function(o){var c=o.currentPostion,f=o.actionType,B=o.onClose,b=(0,T.useModel)("chain"),d=b.chain,i=b.wallet,r=(0,T.useModel)("future"),a=r.updatePositions,h=r.setPairsLoading,P=(0,T.useIntl)(),m=P.formatMessage,J=y.Z.useToken(),L=J.token.colorTextSecondary,ve=c.userMargin,k=c.collateralTokenObj,xe=c.indexTokenObj,me=c.isLong,ke=c.pair,ge=c.userLiqPrice;if(!k||!xe||!ke||!d||!i)return(0,t.jsx)(t.Fragment,{});var se=k.userTokenBalance,Ze=(0,C.useState)(!1),Q=S()(Ze,2),De=Q[0],fe=Q[1],Re=(0,C.useState)(0),ze=S()(Re,2),D=ze[0],pe=ze[1],$e=(0,C.useState)(""),re=S()($e,2),Me=re[0],je=re[1],V=(0,C.useState)(),Ie=S()(V,2),R=Ie[0],Le=Ie[1],Ae=(0,C.useState)(),Se=S()(Ae,2),Ne=Se[0],w=Se[1],Ce=(0,C.useMemo)(function(){return f==="remove"?(0,F.xu)(c):"0"},[f]);(0,C.useEffect)(function(){var u=(0,F.tm)({isAdd:f==="add",currentPostion:c,amountIn:String(D)}),Z=S()(u,2),W=Z[0],p=Z[1];if(p){console.log(p.error),je(p.error);return}Le(W),je("")},[c,D]);var G=function(Z){pe(Z)},Oe=function(){var u=O()(g()().mark(function Z(){var W,p,ye,ae,oe,ie,be,M;return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(fe(!0),f!=="add"){v.next=15;break}return v.next=4,(0,F.Ue)({chain:d,wallet:i,collateralToken:k,indexToken:xe.id,isLong:me,amountIn:String(D)});case 4:if(W=v.sent,p=S()(W,2),ye=p[0],ae=p[1],!ae){v.next=12;break}return _.ZP.error(ae.error),fe(!1),v.abrupt("return");case 12:w({show:!0,onClose:function(){w(void 0)},type:"addMargin",title:"Add Margin Success",hash:ye.hash,okText:"Close"}),v.next=26;break;case 15:return v.next=17,(0,F.CL)({chain:d,wallet:i,collateralToken:k,indexToken:xe.id,isLong:me,amountIn:String(D)});case 17:if(oe=v.sent,ie=S()(oe,2),be=ie[0],M=ie[1],!M){v.next=25;break}return _.ZP.error(M.error),fe(!1),v.abrupt("return");case 25:w({show:!0,onClose:function(){w(void 0),B()},type:"removeMargin",title:"Remove Margin Success",hash:be.hash,okText:"Close"});case 26:return h(!0),v.next=29,a();case 29:fe(!1);case 30:case"end":return v.stop()}},Z)}));return function(){return u.apply(this,arguments)}}(),q=function(Z){var W=Z.label,p=Z.children;return(0,t.jsxs)(I.Z,{className:"InputCardTip",style:{fontSize:13,color:L},children:[(0,t.jsx)(l.Z,{children:W}),(0,t.jsx)(l.Z,{children:p})]})};return(0,t.jsxs)(x.Z,{spinning:De,children:[(0,t.jsxs)(I.Z,{gutter:[10,10],className:"hayMarginWrap",children:[(0,t.jsx)(l.Z,{span:24,children:(0,t.jsx)(ee.Z,{tokenList:[],currentToken:k,onTokenChange:function(){},canSelectToken:!1,amount:D,onAmountChange:G,minValue:0,maxValue:Number(f==="add"?se:Ce),header:f==="add"?(0,t.jsxs)("div",{className:"label",children:[(0,t.jsxs)(N.Z.Text,{style:{color:L,fontSize:13},children:[m({id:"current_margin"}),": $",ve]}),(0,t.jsxs)(N.Z.Text,{style:{color:L,fontSize:13},children:[m({id:"wallet_bal"}),":\xA0",(0,t.jsx)("span",{className:"linkColor",onClick:function(){return G(Number(se))},children:se})]})]}):(0,t.jsxs)("div",{className:"label",children:[(0,t.jsxs)(N.Z.Text,{style:{color:L,fontSize:13},children:[m({id:"max_removable"}),":",(0,t.jsx)("span",{className:"linkColor",onClick:function(){return G(parseFloat(Ce))},children:Ce})]}),(0,t.jsxs)(N.Z.Text,{style:{color:L,fontSize:13},children:[m({id:"current_margin"}),": ",ve]})]})})}),(0,t.jsx)(l.Z,{span:24,children:R&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(q,{label:"Leverage",children:[R.oldLeverage," ",(0,t.jsx)(E.Z,{})," ",R.newLeverage]}),(0,t.jsxs)(q,{label:"Margin Rate",children:[R.oldMr," ",(0,t.jsx)(E.Z,{})," ",R.newMr]}),(0,t.jsx)(q,{label:"Maintenance Margin Rate",children:R.mmr}),(0,t.jsxs)(q,{label:"EST Liq. Price",children:["$",ge," ",(0,t.jsx)(E.Z,{}),"  $",R.newLiqPrice]})]})}),(0,t.jsx)(l.Z,{span:24,children:(0,t.jsx)(K.Z,{height:50,onClick:Oe,conditions:[{condition:!!Me,text:Me,type:"default",onClick:function(){}},{condition:!D,text:"Enter Amount",type:"default",onClick:function(){}}],children:m(f==="add"?{id:"incrase_margin"}:{id:"withdraw_margin"})})})]}),Ne&&(0,t.jsx)(ce.Z,j()({},Ne))]})},n=function(o){var c=o.defaultAction,f=(0,C.useState)(),B=S()(f,2),b=B[0],d=B[1];return(0,C.useEffect)(function(){d(c)},[c]),(0,t.jsxs)(I.Z,{gutter:[10,10],className:"Borrow-Comp",children:[(0,t.jsx)(l.Z,{span:"24",children:(0,t.jsx)(Te.Z,{style:{width:"100%"},value:b,onChange:function(r){return d(r)},block:!0,options:[{label:(0,t.jsx)("div",{style:{padding:4},children:(0,t.jsx)("div",{children:"Add Margin"})}),value:"add"},{label:(0,t.jsx)("div",{style:{padding:4},children:(0,t.jsx)("div",{children:"Remove Margin"})}),value:"remove"}]})}),(0,t.jsx)(l.Z,{span:"24",style:{overflow:"hidden"},children:(0,t.jsxs)(I.Z,{wrap:!1,gutter:[20,20],style:{transform:"translateX(".concat(b==="add"?"0":"-100","%)"),transition:"transform .4s ease-in-out"},children:[(0,t.jsx)(l.Z,{span:"24",children:(0,t.jsx)(Y,j()(j()({},o),{},{actionType:"add"}))}),(0,t.jsx)(l.Z,{span:"24",children:(0,t.jsx)(Y,j()(j()({},o),{},{actionType:"remove"}))})]})})]})},ne=function(o){var c=o.show,f=o.onClose;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ue.Z,{show:c,onClose:f,closable:!0,maskClosable:!1,title:"Edit Margin",children:(0,t.jsx)(n,j()({},o))})})},he=ne},64170:function(Be,$,e){e.r($),e.d($,{default:function(){return _}});var le=e(5574),j=e.n(le),A={action:"action___EGR7o",close:"close___vgRrw",green:"green___pGgMH",red:"red___gGX68",table:"table___M7lZO",type:"type___YF3x5",text:"text___IECwc"},g=e(71577),de=e(83259),O=e(67294),H=e(41687),S=e(79886),C=e(30436),s=e(85893);function y(){var I=(0,H.useIntl)(),l=I.formatMessage,x=function(i){return l({id:i})},N=(0,H.useModel)("chain"),Te=N.chain,T=N.wallet,E=(0,H.useModel)("future"),K=E.positionList,ue=E.positionLoading,F=(0,O.useState)(!1),ee=j()(F,2),ce=ee[0],t=ee[1],Pe=(0,O.useState)(!1),Y=j()(Pe,2),n=Y[0],ne=Y[1],he=(0,O.useState)(),te=j()(he,2),o=te[0],c=te[1],f=function(i){c(i),t(!0)},B=function(i){c(i),ne(!0)},b=[{title:(0,s.jsxs)("div",{children:[x("positions"),(0,s.jsx)("br",{}),x("funding_rate")]}),dataIndex:"positions",key:"positions",align:"left",render:function(i,r){var a=r.indexTokenObj,h=r.isLong,P=r.leverage,m=r.userFundingRate;return(0,s.jsxs)("div",{className:A.type,children:[(0,s.jsx)("span",{className:h?"longColor":"ShortColor",children:h?"L":"S"})," ",a.symbol," ",(0,s.jsxs)("span",{className:A.text,children:[P,"x"]}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:A.text,children:[m,"%/1h"]})]})}},{title:(0,s.jsxs)("div",{children:[x("size"),(0,s.jsx)("br",{})," ",x("pnl"),"/",x("roe")]}),dataIndex:"userSize",key:"userSize",align:"right",render:function(i,r){var a=r.indexTokenObj,h=r.isPositive,P=r.pnlStr,m=r.roeStr;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[Number(i).toFixed(4)," ",a.symbol]}),(0,s.jsxs)("div",{className:h?"longColor":"shortColor",children:[P," (",m,")"]})]})}},{title:(0,s.jsxs)(s.Fragment,{children:[x("margin"),(0,s.jsx)("br",{}),x("value")]}),dataIndex:"userMargin",key:"userMargin",align:"right",render:function(i,r){var a=r.collateralTokenObj,h=r.userMarginUSD;return(0,s.jsxs)("div",{children:[i," ",a.symbol," ",(0,s.jsx)("br",{}),"$",h]})}},{title:(0,s.jsxs)(s.Fragment,{children:[x("entry_price"),(0,s.jsx)("br",{}),x("liq_price")]}),dataIndex:"userEntryIndexPrice",key:"userEntryIndexPrice",align:"right",render:function(i,r){var a=r.userLiqPrice;return(0,s.jsxs)("div",{children:["$",i,(0,s.jsx)("br",{}),"$",a]})}},{title:(0,s.jsxs)(s.Fragment,{children:[x("mr"),(0,s.jsx)("br",{}),x("mmr")]}),dataIndex:"mr",key:"mr",align:"right",render:function(i,r){var a=r.userMmr,h=r.mr_str;return(0,s.jsxs)("div",{children:[h,(0,s.jsx)("br",{}),a,"%"]})}},{title:x("manage"),dataIndex:"manage",key:"manage",align:"center",render:function(i,r){return(0,s.jsxs)("div",{className:A.action,children:[(0,s.jsx)(g.Z,{type:"link",onClick:function(){return f(r)},size:"small",style:{fontSize:13},children:x("edit_margin")}),(0,s.jsx)(g.Z,{type:"link",onClick:function(){return B(r)},size:"small",style:{fontSize:13},children:x("close")})]})}}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(de.Z,{columns:b,dataSource:K.filter(function(d){return d.size>0&&d.userSize}),className:A.table,rowKey:"id",loading:ue}),o&&(0,s.jsx)(S.default,{onClose:function(){return t(!1)},show:ce,currentPostion:o,defaultAction:"add"},o.id),o&&(0,s.jsx)(C.default,{onClose:function(){return ne(!1)},show:n,currentPostion:o,defaultAction:"close"},o.id)]})}var _=y}}]);
